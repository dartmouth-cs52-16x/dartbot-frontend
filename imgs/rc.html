<!DOCTYPE html>
<!-- saved from url=(0079)https://simonsmith.io/using-webpack-to-build-react-components-and-their-assets/ -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Using webpack to build React components and their assets – simonsmith.io</title>
    <link href="./rc_files/css" rel="stylesheet">
    <link href="./rc_files/site-38a7d9b2.css" rel="stylesheet" type="text/css">
    <script>
      var ga = ga || function() {
        (ga.q = ga.q || []).push(arguments);
      };
      ga.l = 1 * new Date();
      ga('create', 'UA-6798894-3', 'auto');
      ga('send', 'pageview');
    </script>
    <script async="" src="./rc_files/analytics.js"></script>
    <link rel="alternate" type="application/rss+xml" title="simonsmith.io - blog RSS" href="https://simonsmith.io/feed.xml">
  </head>
  <body>
    <div hidden="">
      <svg xmlns="http://www.w3.org/2000/svg"><symbol id="icon-email" viewBox="0 0 14 14"><g fill="#030104"><path d="M7 9L5.268 7.484.316 11.73c.18.166.423.27.69.27h11.987c.267 0 .51-.104.688-.27L8.733 7.483 7 9z"></path><path d="M13.684 2.27c-.18-.167-.422-.27-.69-.27H1.006c-.267 0-.51.104-.69.273L7 8l6.684-5.73zM0 2.878v8.308L4.833 7.08M9.167 7.08L14 11.185v-8.31"></path></g></symbol><symbol id="icon-github" viewBox="0 0 512 512"><path d="M256 0C114.615 0 0 114.615 0 256s114.615 256 256 256 256-114.615 256-256S397.385 0 256 0zm152.027 408.027c-19.76 19.76-42.756 35.267-68.354 46.094-6.502 2.75-13.105 5.165-19.8 7.247V423c0-20.167-6.917-35-20.75-44.5 8.667-.833 16.624-2 23.874-3.5s14.918-3.667 23-6.5c8.084-2.833 15.334-6.208 21.75-10.125 6.418-3.917 12.584-9 18.5-15.25 5.918-6.25 10.875-13.333 14.875-21.25s7.168-17.417 9.5-28.5c2.334-11.083 3.5-23.292 3.5-36.625 0-25.833-8.416-47.833-25.25-66 7.668-20 6.834-41.75-2.5-65.25l-6.25-.75c-4.332-.5-12.125 1.333-23.375 5.5s-23.875 11-37.875 20.5c-19.832-5.5-40.416-8.25-61.75-8.25-21.5 0-42 2.75-61.5 8.25-8.832-6-17.207-10.958-25.124-14.875s-14.25-6.583-19-8-9.167-2.292-13.25-2.625-6.708-.417-7.875-.25-2 .333-2.5.5c-9.333 23.667-10.167 45.417-2.5 65.25-16.833 18.167-25.25 40.167-25.25 66 0 13.333 1.167 25.542 3.5 36.625s5.5 20.583 9.5 28.5 8.958 15 14.875 21.25 12.083 11.333 18.5 15.25 13.667 7.292 21.75 10.125 15.75 5 23 6.5 15.208 2.667 23.875 3.5c-13.667 9.333-20.5 24.167-20.5 44.5v39.115c-7.55-2.247-14.99-4.902-22.3-7.994-25.597-10.826-48.594-26.334-68.353-46.093-19.758-19.758-35.267-42.756-46.093-68.354C46.68 313.195 41 285.043 41 256s5.68-57.195 16.88-83.675c10.826-25.597 26.334-48.594 46.092-68.353 19.758-19.76 42.756-35.267 68.353-46.093C198.805 46.68 226.957 41 256 41s57.195 5.68 83.676 16.88c25.598 10.826 48.594 26.334 68.354 46.092 19.758 19.758 35.266 42.756 46.092 68.353C465.32 198.805 471 226.957 471 256s-5.68 57.195-16.88 83.675c-10.825 25.596-26.335 48.595-46.093 68.352z"></path></symbol><symbol id="icon-instagram" viewBox="0 0 97.395 97.395"><path d="M12.5 0h72.394c6.875 0 12.5 5.09 12.5 12.5v72.395c0 7.41-5.625 12.5-12.5 12.5H12.5c-6.876 0-12.5-5.09-12.5-12.5V12.5C0 5.09 5.624 0 12.5 0zM70.95 10.82c-2.412 0-4.383 1.973-4.383 4.386V25.7c0 2.413 1.97 4.386 4.383 4.386h11.008c2.412 0 4.385-1.973 4.385-4.385V15.207c0-2.413-1.972-4.385-4.384-4.385H70.948zm15.44 30.368h-8.573c.81 2.648 1.25 5.453 1.25 8.355 0 16.2-13.556 29.332-30.275 29.332-16.718 0-30.272-13.132-30.272-29.332 0-2.904.438-5.708 1.25-8.355h-8.945v41.14c0 2.13 1.742 3.873 3.872 3.873h67.822c2.13 0 3.872-1.74 3.872-3.87V41.187h-.003zm-37.6-11.655c-10.8 0-19.56 8.485-19.56 18.953S37.99 67.44 48.79 67.44c10.804 0 19.563-8.486 19.563-18.954s-8.757-18.953-19.56-18.953z"></path></symbol><symbol id="icon-link" viewBox="0 0 457.03 457.03"><path d="M421.512 207.074l-85.795 85.767c-47.352 47.38-124.17 47.38-171.53 0-7.46-7.438-13.295-15.82-18.42-24.464l39.864-39.86c1.896-1.912 4.236-3.007 6.472-4.297 2.756 9.415 7.567 18.33 14.972 25.735 23.648 23.667 62.128 23.634 85.762 0l85.768-85.765c23.666-23.664 23.666-62.135 0-85.78-23.635-23.647-62.105-23.647-85.768 0l-30.5 30.53c-24.75-9.636-51.414-12.227-77.372-8.423l64.99-64.99c47.38-47.37 124.178-47.37 171.558 0 47.357 47.37 47.357 124.18 0 171.547zm-226.804 141.03l-30.52 30.532c-23.647 23.634-62.13 23.634-85.78 0-23.647-23.667-23.647-62.138 0-85.795l85.78-85.766c23.664-23.662 62.12-23.662 85.766 0 7.388 7.39 12.204 16.302 14.986 25.706 2.25-1.307 4.56-2.37 6.454-4.266l39.86-39.845c-5.09-8.68-10.957-17.03-18.42-24.478-47.348-47.37-124.172-47.37-171.543 0L35.527 249.96c-47.366 47.385-47.366 124.172 0 171.553 47.37 47.356 124.177 47.356 171.547 0l65.008-65.003c-25.97 3.826-52.643 1.213-77.372-8.406z"></path></symbol><symbol id="icon-rss" viewBox="0 0 24.332 24.332"><path d="M3.607 17.11C1.617 17.11 0 18.726 0 20.717 0 22.7 1.618 24.32 3.607 24.32s3.607-1.618 3.607-3.603c0-1.99-1.618-3.607-3.607-3.607zM.375 7.95C.17 7.95 0 8.12 0 8.33v4.578c0 .206.17.374.375.374 5.88 0 10.665 4.784 10.665 10.665 0 .205.166.375.375.375h4.597c.21 0 .377-.17.377-.375l-.02-.117C16.306 15.064 9.153 7.95.376 7.95z"></path><path d="M24.31 23.828C24.247 10.68 13.53.01.376.01.17.01 0 .18 0 .387v4.71c0 .208.17.376.375.376 10.186 0 18.472 8.287 18.472 18.473 0 .205.168.375.373.375h4.733c.205 0 .38-.17.38-.374l-.022-.118z"></path></symbol><symbol id="icon-twitter" viewBox="0 0 612 612"><path d="M612 116.258c-22.525 9.98-46.694 16.75-72.088 19.772 25.93-15.527 45.777-40.155 55.184-69.41-24.322 14.378-51.17 24.82-79.775 30.48-22.906-24.438-55.49-39.66-91.63-39.66-69.333 0-125.55 56.218-125.55 125.514 0 9.828 1.11 19.427 3.25 28.606-104.325-5.24-196.834-55.223-258.75-131.174-10.822 18.51-16.98 40.078-16.98 63.1 0 43.56 22.182 81.994 55.836 104.48-20.575-.688-39.926-6.348-56.867-15.756v1.568c0 60.806 43.29 111.554 100.692 123.104-10.517 2.83-21.607 4.398-33.08 4.398-8.107 0-15.947-.803-23.634-2.333 15.985 49.907 62.336 86.2 117.253 87.194-42.946 33.655-97.098 53.656-155.915 53.656-10.134 0-20.116-.612-29.944-1.72 55.568 35.68 121.537 56.484 192.44 56.484 230.947 0 357.187-191.29 357.187-357.188l-.42-16.253C573.87 163.525 595.21 141.42 612 116.257z" fill="#010002"></path></symbol></svg>
    </div>
    <header class="Header" role="banner">
      <div class="Container">
        <div class="Grid Grid--alignMiddle Grid--withGutter">
          <div class="Header-wrapLogo Grid-cell u-md-size3of12">
            <a class="Logo u-linkNoDecoration" href="https://simonsmith.io/">  <p class="Logo-title">Simon Smith</p>
  <p class="Logo-subtitle">Words and code</p>
</a>
          </div>
          <div class="Header-wrapNav Grid-cell u-md-size9of12">
            <nav class="Nav" role="navigation">
  <p class="u-hiddenVisually">Site navigation</p>
  <ul class="Nav-list u-listUnstyled">
    <li class="Nav-item is-active">
      <a class="Nav-link u-linkMuted u-linkNoDecoration" href="https://simonsmith.io/">Blog</a>
    </li>
    <li class="Nav-item ">
      <a class="Nav-link u-linkMuted u-linkNoDecoration" href="https://simonsmith.io/projects">Projects</a>
    </li>
    <li class="Nav-item ">
      <a class="Nav-link u-linkMuted u-linkNoDecoration" href="https://simonsmith.io/cv">CV</a>
    </li>
  </ul>
</nav>
          </div>
        </div>
      </div>
    </header>
    <main class="Container Container--main" role="main">
      <div class="Grid Grid--withGutter">
        <div class="Grid-cell u-md-size9of12">
              <div class="Entry">
    <header class="Entry-header">
      <h1 class="Entry-title">Using webpack to build React components and their assets</h1>
      <time class="Entry-date">May 10 2015</time>
    </header>
    <div class="Entry-body js-entry-body">
      <p>I recently stumbled across <a href="https://www.youtube.com/watch?v=L8w3v9m6G04">an excellent talk</a> by Nicolas Gallagher at dotCSS 2014 titled “Thinking beyond Scalable CSS” where he shed some light on how Twitter organise their UI components.</p>

<p>I found two slides interesting in particular:</p>

<div class="Entry-wrapImg Grid">
  <div class="Grid-cell u-sm-size1of2">
    <img class="Entry-img" src="./rc_files/slide1-f82b1e89.png">
  </div>
  <div class="Grid-cell u-sm-size1of2">
    <img class="Entry-img" src="./rc_files/slide2-77f9e4a8.png">
  </div>
</div>

<p>I thought it might be interesting to apply a similar approach to organising <a href="https://facebook.github.io/react/">React</a> components with <a href="https://simonsmith.io/using-webpack-to-build-react-components-and-their-assets/webpack.github.io">webpack</a>.</p>

<h2 id="directory-structure"><a class="Entry-anchor" href="https://simonsmith.io/using-webpack-to-build-react-components-and-their-assets/#directory-structure"><svg class="Icon Icon--lg"><use xlink:href="#icon-link"></use></svg></a>Directory structure</h2>

<p>I’ll use a fictional React application as an example:</p>
<pre class="highlight shell"><code>├── components
│&nbsp;&nbsp; ├── ui-App
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── index.css
│&nbsp;&nbsp; │&nbsp;&nbsp; └── index.js
│&nbsp;&nbsp; ├── ui-Avatar
│&nbsp;&nbsp; │&nbsp;&nbsp; ├── index.css
│&nbsp;&nbsp; │&nbsp;&nbsp; └── index.js
│&nbsp;&nbsp; └── ui-Profile
│&nbsp;&nbsp;     ├── fonts
│&nbsp;&nbsp;     │&nbsp;&nbsp; └── opensans-regular-webfont.woff
│&nbsp;&nbsp;     ├── images
│&nbsp;&nbsp;     │&nbsp;&nbsp; └── icon-user.png
│&nbsp;&nbsp;     ├── index.css
│&nbsp;&nbsp;     └── index.js
└── styles
    ├── base.css
    └── theme.css
</code></pre>

<p>The idea here is to keep React components and their assets contained inside individual directories within <code>components</code>. The <code>ui-App</code> component can act as our top level that brings them all together.</p>

<p>Adjacent to that directory are <code>styles</code> that can apply to the whole application, agnostic of any components.</p>

<h2 id="using-app-as-the-entry-point"><a class="Entry-anchor" href="https://simonsmith.io/using-webpack-to-build-react-components-and-their-assets/#using-app-as-the-entry-point"><svg class="Icon Icon--lg"><use xlink:href="#icon-link"></use></svg></a>Using App as the entry point</h2>

<p>When building applications with webpack you need to define one or more entry points so that it knows where to begin hunting for dependencies. Since it’s fairly common for React components to have a top level ‘controller’ component this seems a good place to start.</p>

<p><strong>ui-App/index.js</strong></p>
<pre class="highlight javascript"><code><span class="kr">import</span> <span class="s1">'./index.css'</span><span class="p">;</span>

<span class="kr">import</span> <span class="nx">React</span> <span class="nx">from</span> <span class="s1">'react'</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">Profile</span> <span class="nx">from</span> <span class="s1">'components/ui-Profile'</span><span class="p">;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
  <span class="na">displayName</span><span class="p">:</span> <span class="s1">'App'</span><span class="p">,</span>

  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">"App"</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">div</span> <span class="nx">className</span><span class="o">=</span><span class="s2">"App-item"</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="nx">Profile</span> <span class="nx">user</span><span class="o">=</span><span class="p">{</span><span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">.</span><span class="nx">userData</span><span class="p">}</span><span class="sr">/</span><span class="err">&gt;
</span>        <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>      <span class="o">&lt;</span><span class="sr">/div</span><span class="err">&gt;
</span>    <span class="p">)</span>
  <span class="p">}</span>
<span class="p">});</span>
</code></pre>

<p>It does nothing more than pull in a <code>Profile</code> component and then render it with some data. Note that a reference to the <code>index.css</code> is also included with the JS dependencies.</p>

<p>What’s interesting to note is that the <code>Profile</code> component will have also listed any dependencies (CSS, images etc) that it needs and with the help of webpack we can grab hold of those too and ensure they’re packaged up.</p>

<h2 id="configuring-webpack"><a class="Entry-anchor" href="https://simonsmith.io/using-webpack-to-build-react-components-and-their-assets/#configuring-webpack"><svg class="Icon Icon--lg"><use xlink:href="#icon-link"></use></svg></a>Configuring webpack</h2>

<p>For everything to work smoothly we’ll need to tell webpack how to handle the various files it encounters. We can do this with <a href="http://webpack.github.io/docs/loaders.html">loaders</a>:</p>
<pre class="highlight javascript"><code><span class="kd">var</span> <span class="nx">ExtractTextPlugin</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'extract-text-webpack-plugin'</span><span class="p">);</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">entry</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">homepage</span><span class="p">:</span> <span class="s1">'./src/components/ui-App/'</span><span class="p">,</span>
  <span class="p">},</span>

  <span class="na">output</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">path</span><span class="p">:</span> <span class="s1">'./dist/'</span><span class="p">,</span>
    <span class="na">filename</span><span class="p">:</span> <span class="s1">'app.js'</span>
  <span class="p">},</span>

  <span class="c1">// Resolve the `./src` directory so we can avoid writing</span>
  <span class="c1">// ../../styles/base.css</span>
  <span class="na">resolve</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">modulesDirectories</span><span class="p">:</span> <span class="p">[</span><span class="s1">'node_modules'</span><span class="p">,</span> <span class="s1">'./src'</span><span class="p">],</span>
    <span class="na">extensions</span><span class="p">:</span> <span class="p">[</span><span class="s1">''</span><span class="p">,</span> <span class="s1">'.js'</span><span class="p">,</span> <span class="s1">'.jsx'</span><span class="p">]</span>
  <span class="p">},</span>

  <span class="c1">// Instruct webpack how to handle each file type that it might encounter</span>
  <span class="na">module</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">loaders</span><span class="p">:[</span>
      <span class="p">{</span> <span class="na">test</span><span class="p">:</span> <span class="sr">/</span><span class="se">\.</span><span class="sr">js</span><span class="se">[</span><span class="sr">x</span><span class="se">]?</span><span class="sr">$/</span><span class="p">,</span> <span class="na">exclude</span><span class="p">:</span> <span class="sr">/node_modules/</span><span class="p">,</span> <span class="na">loader</span><span class="p">:</span> <span class="s1">'babel-loader'</span> <span class="p">},</span>
      <span class="p">{</span> <span class="na">test</span><span class="p">:</span> <span class="sr">/</span><span class="se">\.</span><span class="sr">css$/</span><span class="p">,</span> <span class="na">loader</span><span class="p">:</span> <span class="nx">ExtractTextPlugin</span><span class="p">.</span><span class="nx">extract</span><span class="p">(</span><span class="s1">'style-loader'</span><span class="p">,</span> <span class="s1">'css-loader'</span><span class="p">)</span> <span class="p">},</span>
      <span class="p">{</span> <span class="na">test</span><span class="p">:</span> <span class="sr">/</span><span class="se">\.(</span><span class="sr">png|jpg</span><span class="se">)</span><span class="sr">$/</span><span class="p">,</span> <span class="na">loader</span><span class="p">:</span> <span class="s1">'file-loader?name=images/[name].[ext]'</span> <span class="p">},</span>
      <span class="p">{</span> <span class="na">test</span><span class="p">:</span> <span class="sr">/</span><span class="se">\.</span><span class="sr">woff$/</span><span class="p">,</span> <span class="na">loader</span><span class="p">:</span> <span class="s1">'file-loader?name=fonts/[name].[ext]'</span> <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">},</span>

  <span class="c1">// This plugin moves all the CSS into a separate stylesheet</span>
  <span class="na">plugins</span><span class="p">:</span> <span class="p">[</span>
    <span class="k">new</span> <span class="nx">ExtractTextPlugin</span><span class="p">(</span><span class="s1">'app.css'</span><span class="p">)</span>
  <span class="p">]</span>
<span class="p">};</span>

</code></pre>

<p>The <a href="https://github.com/webpack/file-loader">file loader</a> is used to pick up binary assets and copy them to a relevant directory. The path to the asset is then returned so that they can be referenced from the CSS.</p>

<p>Loaders can be chained together to allow additional processing of assets, such as CSS preprocessors or <a href="https://github.com/tcoopman/image-webpack-loader">image compression</a>. In the above example we’re also using the <a href="http://webpack.github.io/docs/stylesheets.html#separate-css-bundle">ExtractTextPlugin</a> to resolve the dependency graph for the CSS and output it into a separate file.</p>

<p>At this point if we try running the <code>webpack</code> command there should be a <code>dist</code> folder containing everything:</p>
<pre class="highlight shell"><code>dist/
├── app.css
├── app.js
├── fonts
│&nbsp;&nbsp; └── opensans-regular-webfont.woff
└── images
    └── icon-user.png
</code></pre>

<h2 id="including-additional-global-styles"><a class="Entry-anchor" href="https://simonsmith.io/using-webpack-to-build-react-components-and-their-assets/#including-additional-global-styles"><svg class="Icon Icon--lg"><use xlink:href="#icon-link"></use></svg></a>Including additional global styles</h2>

<p>So far the CSS from the <code>styles</code> directory has not been included. There are two approaches to this.</p>

<h3 id="each-component-explictly-requires-style-dependencies"><a class="Entry-anchor" href="https://simonsmith.io/using-webpack-to-build-react-components-and-their-assets/#each-component-explictly-requires-style-dependencies"><svg class="Icon Icon--lg"><use xlink:href="#icon-link"></use></svg></a>Each component explictly requires style dependencies</h3>

<p>If the intention is for components to be reused in other projects it might make sense for each one to require the styles it needs, even if this means you have repeated <code>require</code> or <code>import</code> statements:</p>

<p><strong>ui-Profile/index.js</strong></p>
<pre class="highlight javascript"><code><span class="kr">import</span> <span class="s1">'suitcss-base'</span><span class="p">;</span>
<span class="kr">import</span> <span class="s1">'styles/theme.css'</span><span class="p">;</span>
<span class="kr">import</span> <span class="s1">'styles/base.css'</span><span class="p">;</span>
<span class="kr">import</span> <span class="s1">'./index.css'</span><span class="p">;</span>

<span class="c1">// ...rest of the component</span>
</code></pre>

<p><strong>ui-Avatar/index.js</strong></p>
<pre class="highlight javascript"><code><span class="kr">import</span> <span class="s1">'suitcss-base'</span><span class="p">;</span>
<span class="kr">import</span> <span class="s1">'styles/theme.css'</span><span class="p">;</span>
<span class="kr">import</span> <span class="s1">'styles/base.css'</span><span class="p">;</span>
<span class="kr">import</span> <span class="s1">'./index.css'</span><span class="p">;</span>

<span class="c1">// ...rest of the component</span>
</code></pre>

<p>webpack will be smart enough to see if more than one component has requested the same stylesheet and ensure the order is correct and without duplicates in the resulting <code>.css</code> file.</p>

<h3 id="require-all-style-dependencies-in-the-top-level-component"><a class="Entry-anchor" href="https://simonsmith.io/using-webpack-to-build-react-components-and-their-assets/#require-all-style-dependencies-in-the-top-level-component"><svg class="Icon Icon--lg"><use xlink:href="#icon-link"></use></svg></a>Require all style dependencies in the top level component</h3>

<p>On the other hand if you know that the components are unlikely to live outside of this app, or that the styles are too app specific then it sometimes makes sense to just include them at the top level component instead.</p>

<p><strong>ui-App/index.js</strong></p>
<pre class="highlight javascript"><code><span class="kr">import</span> <span class="s1">'suitcss-base'</span><span class="p">;</span>
<span class="kr">import</span> <span class="s1">'styles/theme.css'</span><span class="p">;</span>
<span class="kr">import</span> <span class="s1">'styles/base.css'</span><span class="p">;</span>
<span class="kr">import</span> <span class="s1">'./index.css'</span><span class="p">;</span>

<span class="c1">// ...rest of the component</span>
</code></pre>

<p><strong>ui-Profile/index.js</strong></p>
<pre class="highlight javascript"><code><span class="kr">import</span> <span class="s1">'./index.css'</span><span class="p">;</span>

<span class="c1">// ...rest of the component</span>
</code></pre>

<p><strong>ui-Avatar/index.js</strong></p>
<pre class="highlight javascript"><code><span class="kr">import</span> <span class="s1">'./index.css'</span><span class="p">;</span>

<span class="c1">// ...rest of the component</span>
</code></pre>

<blockquote>
<p><a href="https://github.com/suitcss/base"><code>suitcss-base</code></a> would need to be installed from <code>npm</code> in the above examples</p>
</blockquote>

<p>Now if webpack was run for a second time the <code>app.css</code> would contain the additional styles.</p>

<h2 id="adding-postcss-as-an-additional-loader"><a class="Entry-anchor" href="https://simonsmith.io/using-webpack-to-build-react-components-and-their-assets/#adding-postcss-as-an-additional-loader"><svg class="Icon Icon--lg"><use xlink:href="#icon-link"></use></svg></a>Adding PostCSS as an additional loader</h2>

<p><a href="https://github.com/postcss/postcss">PostCSS</a> is a post-processor that allows transformation of CSS with various JS plugins, many of which are very useful like <a href="https://github.com/postcss/autoprefixer">autoprefixer</a>.</p>

<p>It’s a great tool (Twitter is already using it) with <a href="https://github.com/postcss/postcss#plugins">some excellent plugins</a> and one of those is <a href="https://github.com/postcss/postcss-import">postcss-import</a>. This can offer us the alternate route of letting the CSS files manage their dependencies instead of the JS.</p>

<p>To use it we need to add a <a href="https://github.com/postcss/postcss-loader">postcss-loader</a> into the mix, which is as simple as installing it from npm and updating the <code>webpack.config.js</code>:</p>
<pre class="highlight shell"><code>npm install postcss-loader
</code></pre>

<p><strong>webpack.config.js</strong></p>
<pre class="highlight javascript"><code><span class="c1">// Only showing additions</span>

<span class="kd">var</span> <span class="nx">atImport</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'postcss-import'</span><span class="p">);</span>

<span class="nl">module</span><span class="p">:</span> <span class="p">{</span>
  <span class="nl">loaders</span><span class="p">:</span> <span class="p">[</span> <span class="p">{</span> <span class="na">test</span><span class="p">:</span> <span class="sr">/</span><span class="se">\.</span><span class="sr">css$/</span><span class="p">,</span> <span class="na">loader</span><span class="p">:</span> <span class="nx">ExtractTextPlugin</span><span class="p">.</span><span class="nx">extract</span><span class="p">(</span><span class="s1">'style-loader'</span><span class="p">,</span> <span class="s1">'css-loader!postcss-loader'</span><span class="p">)</span> <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>

<span class="p">{</span>
  <span class="nl">postcss</span><span class="p">:</span> <span class="p">[</span>
    <span class="nx">atImport</span><span class="p">({</span>
      <span class="na">path</span><span class="p">:</span> <span class="p">[</span><span class="s1">'node_modules'</span><span class="p">,</span> <span class="s1">'./src'</span><span class="p">]</span>
    <span class="p">})</span>
    <span class="c1">// Other PostCSS plugins</span>
  <span class="p">]</span>
<span class="p">}</span>
</code></pre>

<p>With that in place the <code>import</code> statements from the JS files can move into the CSS:</p>

<p><strong>ui-App/index.js</strong></p>
<pre class="highlight javascript"><code><span class="kr">import</span> <span class="s1">'./index.css'</span><span class="p">;</span>

<span class="kr">import</span> <span class="nx">React</span> <span class="nx">from</span> <span class="s1">'react'</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">Profile</span> <span class="nx">from</span> <span class="s1">'components/ui-Profile'</span><span class="p">;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="nx">React</span><span class="p">.</span><span class="nx">createClass</span><span class="p">({</span>
<span class="c1">// ...rest of the component</span>
<span class="p">});</span>
</code></pre>

<p><strong>ui-App/index.css</strong></p>
<pre class="highlight css"><code><span class="k">@import</span> <span class="s2">'styles/theme.css'</span><span class="p">;</span>
<span class="k">@import</span> <span class="s2">'styles/base.css'</span><span class="p">;</span>

<span class="nc">.App-item</span> <span class="p">{</span>
  <span class="nl">width</span><span class="p">:</span> <span class="m">300px</span><span class="p">;</span>
<span class="p">}</span>
</code></pre>

<p>The dependencies will now be resolved the same way as before.</p>

<h2 id="linting-css-components"><a class="Entry-anchor" href="https://simonsmith.io/using-webpack-to-build-react-components-and-their-assets/#linting-css-components"><svg class="Icon Icon--lg"><use xlink:href="#icon-link"></use></svg></a>Linting CSS components</h2>

<p>One slide from the talk demonstrated use of another PostCSS plugin - <a href="https://github.com/necolas/postcss-bem-linter">postcss-bem-linter</a>:</p>

<p><figure class="Entry-wrapImg"><img src="./rc_files/slide3-6e012ea8.png" class="Entry-img"></figure></p>

<p>This checks that CSS components conform to predefined naming conventions and now that our webpack config is using PostCSS this can easily be dropped in:</p>
<pre class="highlight shell"><code>npm install postcss-bem-linter
</code></pre>
<pre class="highlight javascript"><code><span class="p">{</span>
  <span class="nl">postcss</span><span class="p">:</span> <span class="p">[</span>
    <span class="nx">atImport</span><span class="p">(),</span>
    <span class="nx">autoprefixer</span><span class="p">(),</span>
    <span class="nx">bemLinter</span><span class="p">()</span>
  <span class="p">]</span>
<span class="p">}</span>
</code></pre>

<p>Now, if any of the components fail the linting then the error is reported to us in the console:</p>
<pre class="highlight shell"><code>WARNING <span class="k">in</span> ./~/css-loader!./~/postcss-loader!./src/components/ui-Profile/index.css
    postcss-bem-linter: /Users/simonsmith/Sites/react-webpack-assets/src/components/ui-Profile/index.css:10:1: Invalid component selector <span class="s2">".Profil"</span>
</code></pre>

<h2 id="wrapping-up"><a class="Entry-anchor" href="https://simonsmith.io/using-webpack-to-build-react-components-and-their-assets/#wrapping-up"><svg class="Icon Icon--lg"><use xlink:href="#icon-link"></use></svg></a>Wrapping up</h2>

<p>Hopefully that sheds some light on how powerful tools like webpack and PostCSS are and how useful they can be in your build pipeline.</p>

<p>The code in this post is <a href="https://github.com/simonsmith/react-component-assets-webpack">viewable on GitHub</a> with a working example.</p>

<h3 id="resources"><a class="Entry-anchor" href="https://simonsmith.io/using-webpack-to-build-react-components-and-their-assets/#resources"><svg class="Icon Icon--lg"><use xlink:href="#icon-link"></use></svg></a>Resources</h3>

<ul>
<li><a href="https://www.youtube.com/watch?v=L8w3v9m6G04">Thinking beyond “Scalable CSS”</a>  - <a href="https://speakerdeck.com/necolas/thinking-beyond-scalable-css">Slides</a></li>
<li><a href="https://vimeo.com/109918301">Making Twitter UI Infrastructure</a> - <a href="https://speakerdeck.com/necolas/making-twitter-ui-infrastructure">Slides</a></li>
<li><a href="https://medium.com/seek-ui-engineering/block-element-modifying-your-javascript-components-d7f99fcab52b">Block, Element, Modifying Your JavaScript Components</a></li>
<li><a href="http://suitcss.github.io/">SUIT CSS</a></li>
</ul>

    </div>
  </div>


        </div>
        <div class="Grid-cell u-md-size3of12 u-md-flexOrderFirst">
          <div class="Aside">
            <div class="Aside-item u-pt30">
              <div class="Profile">
  <h1 class="u-hiddenVisually">About</h1>
  <div class="Profile-wrapAvatar">
    <img class="Avatar u-imgCircle" src="./rc_files/avatar-01170ee7.jpg" srcset="/images/avatar@2x-baa59573.jpg 2x" alt="">
  </div>
  <div class="Profile-body">
    <p class="Profile-text">Hi, I build things with code, usually consisting of HTML5, CSS &amp; JavaScript</p>
    <p class="Profile-text">Sometimes I write about it too</p>
  </div>
</div>
            </div>
            <div class="Aside-item u-p10">
              <div class="Contact">
  <h2 class="Contact-header">Get in touch</h2>
  <ul class="Contact-list u-listUnstyled">
      <li class="Contact-item">
        <a class="u-linkNoDecoration u-linkMuted" href="mailto:me@simonsmith.io">
          <svg class="Icon">
            <use xlink:href="#icon-email"></use>
          </svg>
          me@simonsmith.io
        </a>
      </li>
      <li class="Contact-item">
        <a class="u-linkNoDecoration u-linkMuted" href="http://twitter.com/blinkdesign">
          <svg class="Icon">
            <use xlink:href="#icon-twitter"></use>
          </svg>
          @blinkdesign
        </a>
      </li>
      <li class="Contact-item">
        <a class="u-linkNoDecoration u-linkMuted" href="https://github.com/simonsmith">
          <svg class="Icon">
            <use xlink:href="#icon-github"></use>
          </svg>
          Github
        </a>
      </li>
      <li class="Contact-item">
        <a class="u-linkNoDecoration u-linkMuted" href="https://instagram.com/blinkdesign">
          <svg class="Icon">
            <use xlink:href="#icon-instagram"></use>
          </svg>
          Instagram
        </a>
      </li>
  </ul>
</div>

            </div>
          </div>
          <div class="u-mt10 u-textCenter">
            <a class="Rss u-linkNoDecoration u-linkMuted" href="https://simonsmith.io/feed.xml">
  <svg class="Rss-icon Icon">
    <use xlink:href="#icon-rss"></use>
  </svg>
  <span class="Rss-text"><abbr title="Rich Site Summary">blog rss</abbr></span>
</a>

          </div>
        </div>
      </div>
    </main>
    <footer class="Footer" role="contentinfo">
      <div class="Container">
        <div class="Grid Grid--withGutter">
          <div class="Grid-cell u-md-before3of12">
            <p class="Footer-text">
              Simon Smith <time datetime="2016">2016</time> • Built with
              <a class="u-linkMuted u-linkUnderline u-linkNoDecoration" href="http://middlemanapp.com/">Middleman</a> and
              <a class="u-linkMuted u-linkUnderline u-linkNoDecoration" href="http://suitcss.github.io/">SUIT CSS</a> • View
              the sauce
              <a class="u-linkMuted u-linkUnderline u-linkNoDecoration" href="https://github.com/simonsmith/simonsmith.io">on
                GitHub</a>
            </p>
          </div>
        </div>
      </div>
    </footer>
    <script>
      window.$ = document.querySelectorAll.bind(document);
      NodeList.prototype.__proto__ = Array.prototype;
    </script>
          <script src="./rc_files/post-88965985.js" type="text/javascript"></script>

  


</body></html>